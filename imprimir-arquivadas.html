<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Fichas Arquivadas - Impressão</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #4CAF50;
            --primary-dark: #45a049;
            --danger-color: #f44336;
            --gray-light: #f2f2f2;
            --gray-border: #ddd;
            --text-primary: #333;
            --text-secondary: #666;
            --padding-sm: 8px;
            --padding-md: 12px;
            --padding-lg: 16px;
            --border-radius: 6px;
        }

        html {
            font-size: 16px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f5f5f5;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--padding-lg);
        }

        button {
            padding: var(--padding-md) var(--padding-lg);
            margin: var(--padding-md) var(--padding-sm);
            cursor: pointer;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            touch-action: manipulation;
            min-height: 44px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: #999;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #777;
        }

        .action-buttons {
            text-align: center;
            margin-bottom: 2rem;
        }

        @page {
            size: A4;
            margin: 12mm 10mm 15mm 10mm;
        }

        .ficha-container {
            background: white;
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            page-break-after: always;
        }

        .ficha-container:last-child {
            page-break-after: auto;
            margin-bottom: 0;
        }

        .header {
            text-align: left;
            margin-bottom: 1.5rem;
        }

        .header-content {
            display: flex;
            align-items: flex-start;
            gap: 1.5rem;
            margin-bottom: 1rem;
        }

        .brasao {
            width: 80px;
            height: auto;
            flex-shrink: 0;
        }

        .header-text {
            flex: 1;
        }

        .header-text p {
            margin: 0.25rem 0;
            font-size: 0.9rem;
        }

        .header-text p strong {
            font-weight: 600;
        }

        .section-title {
            font-weight: 600;
            margin: 1.5rem 0 1rem 0;
            text-align: center;
            text-decoration: underline;
            font-size: 1rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            page-break-inside: avoid;
        }

        th, td {
            padding: var(--padding-md);
            border: 1px solid var(--gray-border);
            word-break: break-word;
            text-align: left;
        }

        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        .field-row {
            display: grid;
            gap: 1rem;
            margin-bottom: 1rem;
            grid-template-columns: 1fr 1fr;
        }

        .field-row.full {
            grid-template-columns: 1fr;
        }

        .field-group {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .field-label {
            font-weight: 600;
            min-width: 80px;
            font-size: 0.9rem;
        }

        .field-value {
            flex: 1;
            min-width: 150px;
            padding-bottom: 2px;
            border-bottom: 1px solid var(--gray-border);
            font-size: 0.9rem;
        }

        .field-label2 {
            font-weight: 600;
            min-width: 100px;
            font-size: 0.9rem;
        }

        .term-text {
            font-size: 0.9rem;
            line-height: 1.6;
            text-align: justify;
            margin-bottom: 2rem;
        }

        .signature-section {
            margin-top: 2rem;
        }

        .signature-line {
            border-bottom: 1px solid var(--gray-border);
            width: 150px;
            display: inline-block;
            margin: 0 0.5rem;
        }

        .signature-text {
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        @media (max-width: 768px) {
            html {
                font-size: 14px;
            }

            .container {
                padding: var(--padding-md);
            }

            .ficha-container {
                padding: 1.5rem;
                margin-bottom: 1.5rem;
            }

            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .brasao {
                width: 60px;
            }

            .header-text p {
                font-size: 0.85rem;
            }

            .field-row {
                grid-template-columns: 1fr;
            }

            th, td {
                padding: var(--padding-sm);
                font-size: 0.85rem;
            }

            button {
                padding: var(--padding-sm) var(--padding-md);
                font-size: 0.9rem;
                min-height: 40px;
            }

            .signature-line {
                width: 120px;
            }

            .term-text {
                font-size: 0.85rem;
            }
        }

        @media (max-width: 480px) {
            html {
                font-size: 12px;
            }

            .container {
                padding: var(--padding-sm);
            }

            .ficha-container {
                padding: 1rem;
                margin-bottom: 1rem;
            }

            .brasao {
                width: 50px;
            }

            .header-text p {
                font-size: 0.8rem;
            }

            th, td {
                padding: 6px;
                font-size: 0.75rem;
            }

            .field-label,
            .field-label2 {
                font-size: 0.8rem;
                min-width: auto;
            }

            .field-value {
                min-width: 100px;
                font-size: 0.8rem;
            }

            button {
                padding: 6px 10px;
                font-size: 0.8rem;
                min-height: 36px;
            }

            .signature-line {
                width: 100px;
            }

            .term-text {
                font-size: 0.8rem;
            }

            .section-title {
                font-size: 0.9rem;
            }
        }

        @media print {
            .no-print {
                display: none;
            }

            .container {
                max-width: 100%;
                padding: 0;
            }

            .ficha-container {
                box-shadow: none;
                page-break-after: always;
                margin-bottom: 0;
                padding: 0;
            }

            button {
                display: none;
            }

            body {
                background-color: white;
            }
        }

        .text-center {
            text-align: center;
        }

        .mt-2 {
            margin-top: 1.5rem;
        }
    </style>
</head>
<body onload="carregarFichas()">
    <div class="action-buttons no-print">
        <button class="btn-primary" onclick="window.print()">Imprimir</button>
        <button class="btn-secondary" onclick="window.location.href='fichas-arquivadas.html'">Voltar</button>
    </div>

    <div class="container" id="fichasContainer">
    </div>

    <script>
        const operadoresPontos = {
            "Adson Miranda dos Anjos": "914.262",
            "Afonso Viana de Mesquita Filho": "5.947",
            "Alberto Cesar Souza Almeida": "5.302",
            "Alexander Rafael Carvalho Paim": "882.420",
            "Alexandre Alves de Siqueira": "919.956",
            "Alison Silva de Oliveira": "914.799",
            "Allan Cosseti Ardisson": "919.895",
            "Altamir Araújo da Silva": "881.758",
            "Antonio Batista Ângelo": "999.134",
            "Antonio Rodrigues Siqueira Filho": "917.486",
            "Arley Carvalho Alves": "915.546",
            "Breno Doria Felicio": "922.083",
            "Bruno Fernandes Braga": "881.842",
            "Bruno Rodrigues do Prado": "919.894",
            "Bruno Vieira Rodrigues": "922.084",
            "Carlos César Ferreira de Sousa": "5.250",
            "Carlos Cesar José da Silva": "920.074",
            "Carlos Eduardo Guedes da Silva": "882.174",
            "Carlos Roberto de Paiva Miranda dos Santos": "922.498",
            "Cinthia Neves Carvalho Barbosa": "5.476",
            "Cláudio Marcelo do Nascimento": "882.421",
            "Davi Aragão de Paula Gonçalves": "921.627",
            "Douglas Batista da Silva": "920.077",
            "Emmanuel do Amaral Idelfonso": "920.076",
            "Enzo Risso Conturbia": "920.438",
            "Eric Samuel do Ouro": "920.359",
            "Erika Fedosseeff Auler": "921.672",
            "Eromilson Monteiro dutra Chaves": "882.134",
            "Evellyn Mendes de Souza Nunes": "915.974",
            "Fausto Barbosa de Oliveira": "888.223",
            "Felipe Omena Vasconcellos de Assis": "919.593",
            "Fernando de Sousa Vasconcelos": "914.382",
            "Flávio Lima Câmara": "882.218",
            "Francisco de Assis da Silva Sales": "888.744",
            "Francisco de Sousa Filho": "5.953",
            "Francisco Juniel Sousa e Silva": "915.547",
            "Geraldo Ribeiro de Souza Filho": "888.010",
            "Gildo Marques da Silva": "920.092",
            "Gilson Gomes da Silva": "882.541",
            "Gilson Gustavo de Paiva Oliveira": "5.254",
            "Gleisson Carlos Pereira da Silva": "914.815",
            "Guilherme Malheiro da Rocha Pinto": "4.224",
            "Helisson Rafael de O. Leite": "881.759",
            "Helyeber Feitosa Ferreira": "919.899",
            "Hilton Severiano Ferreira": "922.678",
            "Huelisson Amancio de Moraes Silva": "881.596",
            "Igor Mendes dos Santos": "921.292",
            "Isaias Pereira Soares": "919.903",
            "Joel Luiz de Sá Silva": "920.353",
            "Joel Pereira Santos": "882.652",
            "Joilson Santos de Jesus": "920.123",
            "Jônatas Soares de Andrade": "881.598",
            "Jose Henrique Ferreira da Silva": "7.913",
            "José Nilton Abraão de Sousa": "920.352",
            "Joval Bastos Freitas Júnior": "882.702",
            "Juliano Gustavo Pedro de Oliveira": "882.053",
            "Kely Berlinck Freire": "919.896",
            "Kleber de Araújo Moura": "888.397",
            "Leandro Calixto da Silva": "917.992",
            "Leandro Silva Lima Alves": "921.291",
            "Leonardo Augusto de Freitas": "882.688",
            "Letícia Santana Araújo": "920.816",
            "Lívia Maria de Souza": "916.391",
            "Lucas Lima Lira": "919.897",
            "Lucas Ribeiro dos Santos": "919.904",
            "Luciano de Freitas Silva": "881.452",
            "Luis Eduardo Campos Moreira": "919.898",
            "Luiz Henrique Reis de Lima": "888.226",
            "Marcelo Bruno Rezende Costa": "882.728",
            "Marcelo Gomes da Silva": "918.923",
            "Marco Antonio Baldresca Lambert de Brito": "5.261",
            "Marco Antônio Felício Júnior": "915.553",
            "Marcos Borges de Souza": "920.075",
            "Marcus Aurélius Fernandes de Moura": "888.219",
            "Massilon Alves de Sousa Filho": "919.905",
            "Mateus da Silva Lima": "922.278",
            "Matheus Gabriel Damasceno Dias": "920.354",
            "Matheus Henrique Felix Barbosa": "922.082",
            "Múcio Homero Rocha Pires de Oliveira": "5.297",
            "Orlando Villavicencio Venegas": "882.673",
            "Paulo Fernando Volpe": "5.933",
            "Paulo Roberto Pereira": "888.227",
            "Paulo Soares da Costa": "888.228",
            "Pedro Henrique Candido Boaventura": "920.124",
            "Péricles Cruz da Silva": "881.892",
            "Priscilla Amorim dos Santos Rodrigues": "7.914",
            "Rafael Queiroz Lemos de Oliveira": "881.782",
            "Reynaldo Jessé Rodrigues da Silva": "888.131",
            "Richard Rodrigues dos Santos": "921.026",
            "Roberio Antunes Simionato": "5.266",
            "Rodrigo Fonseca Shiratori": "5.272",
            "Rondney Rodrigues Alves Sousa": "881.174",
            "Rosivan Augustinho Pereira": "882.518",
            "Thiago Veríssimo Cabral Freitas": "922.497",
            "Vinícius Veríssimo Cabral Freitas": "919.796",
            "Vivikananda Abdallah Antun Filho": "5.301",
            "Waleria Bastos Cardoso": "915.570",
            "Wanderson Balzan de Sousa": "918.679",
            "Wellington Jorge Souza Mendes": "881.179",
            "Wellington Rodrigo Ribeiro Santana": "882.052",
            "Wendel Vieira da Costa": "919.907",
            "Wesley Laécio da Silva Costa": "882.054",
            "Wesley Maurício Ribeiro França": "888.217",
            "Willian Neves da Silva": "888.230",
            "Wirlem Silva Alves": "919.906"
        };

        function formatarData(dataStr) {
            if (!dataStr) return "N/A";
            const [dataParte, horaParte] = dataStr.split(', ');
            const [dia, mes, ano] = dataParte.split('/');
            return { data: `${dia}/${mes}/${ano}`, hora: horaParte || "N/A" };
        }

        function carregarFichas() {
            const fichas = JSON.parse(localStorage.getItem('fichasParaImprimir'));
            if (!fichas || fichas.length === 0) {
                alert('Nenhuma ficha selecionada para impressão. Redirecionando para a página de fichas arquivadas.');
                window.location.href = 'fichas-arquivadas.html';
                return;
            }

            const container = document.getElementById('fichasContainer');
            fichas.forEach((dadosFicha) => {
                const fichaDiv = document.createElement('div');
                fichaDiv.className = 'ficha-container';

                const retirada = formatarData(dadosFicha.dataRetirada);
                const devolucao = formatarData(dadosFicha.dataDevolucao);

                fichaDiv.innerHTML = `
                    <div class="header">
                        <div class="header-content">
                            <img src="brasao_republica_brasil.jpg" class="brasao" alt="Brasão da República do Brasil">
                            <div class="header-text">
                                <p><strong>CÂMARA DOS DEPUTADOS</strong></p>
                                <p>Coordenação de Engenharia de Telecomunicações e Audiovisual - COAUD</p>
                                <p>Seção de Apoio aos Auditórios e Comissões - SAUDI/SAPCO</p>
                                <p><strong>FICHA DE RETIRADA / EMPRÉSTIMO DE MATERIAL PARA EVENTO</strong></p>
                            </div>
                        </div>
                    </div>

                    <div class="section-title">LISTA DE MATERIAL COM PATRIMÔNIO</div>
                    <table>
                        <thead>
                            <tr>
                                <th>Patrimônio</th>
                                <th>Descrição</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${dadosFicha.equipamentos.map(equip => {
                                const [patrimonio, ...descricaoParts] = equip.split(' - ');
                                const descricao = descricaoParts.join(' - ');
                                return `<tr><td>${patrimonio}</td><td>${descricao}</td></tr>`;
                            }).join('')}
                        </tbody>
                    </table>

                    <div class="section-title">RETIRADA</div>
                    <div class="field-row">
                        <div class="field-group">
                            <span class="field-label">Ficha:</span>
                            <span class="field-value">${dadosFicha.idFicha}</span>
                        </div>
                        <div class="field-group">
                            <span class="field-label">Data:</span>
                            <span class="field-value">${retirada.data}</span>
                        </div>
                    </div>
                    <div class="field-row full">
                        <div class="field-group">
                            <span class="field-label">Evento:</span>
                            <span class="field-value">${dadosFicha.evento}</span>
                        </div>
                    </div>
                    <div class="field-row full">
                        <div class="field-group">
                            <span class="field-label">Local:</span>
                            <span class="field-value">${dadosFicha.local}</span>
                        </div>
                    </div>
                    <div class="field-row">
                        <div class="field-group">
                            <span class="field-label">Hora:</span>
                            <span class="field-value">${retirada.hora}</span>
                        </div>
                    </div>
                    <div class="field-row">
                        <div class="field-group">
                            <span class="field-label">Nome:</span>
                            <span class="field-value">${dadosFicha.operador1}</span>
                        </div>
                        <div class="field-group">
                            <span class="field-label">Ponto:</span>
                            <span class="field-value">${operadoresPontos[dadosFicha.operador1] || 'N/A'}</span>
                        </div>
                    </div>
                    <div class="field-row">
                        <div class="field-group">
                            <span class="field-label2">Almoxarifado:</span>
                            <span class="field-value">${dadosFicha.operador2}</span>
                        </div>
                        <div class="field-group">
                            <span class="field-label">Ponto:</span>
                            <span class="field-value">${operadoresPontos[dadosFicha.operador2] || 'N/A'}</span>
                        </div>
                    </div>

                    <div class="section-title">DEVOLUÇÃO</div>
                    <div class="field-row">
                        <div class="field-group">
                            <span class="field-label">Data:</span>
                            <span class="field-value">${devolucao.data}</span>
                        </div>
                        <div class="field-group">
                            <span class="field-label">Hora:</span>
                            <span class="field-value">${devolucao.hora}</span>
                        </div>
                    </div>
                    <div class="field-row">
                        <div class="field-group">
                            <span class="field-label">Nome:</span>
                            <span class="field-value">${dadosFicha.operadorDevolucao}</span>
                        </div>
                        <div class="field-group">
                            <span class="field-label">Ponto:</span>
                            <span class="field-value">${operadoresPontos[dadosFicha.operadorDevolucao] || 'N/A'}</span>
                        </div>
                    </div>
                    <div class="field-row">
                        <div class="field-group">
                            <span class="field-label2">Almoxarifado:</span>
                            <span class="field-value">${dadosFicha.almoxarifadoDevolucao}</span>
                        </div>
                        <div class="field-group">
                            <span class="field-label">Ponto:</span>
                            <span class="field-value">${operadoresPontos[dadosFicha.almoxarifadoDevolucao] || 'N/A'}</span>
                        </div>
                    </div>

                    <div class="section-title">TERMO DE EMPRÉSTIMO</div>
                    <p class="term-text">
                        Conforme legislação vigente, o servidor abaixo-assinado e qualificado se responsabiliza pela guarda, zelo e devolução do material acima relacionado, classificado como permanente e de carga patrimonial desta seção de apoio SAUDI/SAPCO, da Coordenação de Engenharia de Telecomunicações e Audiovisual - COAUD.
                    </p>

                    <div class="signature-section">
                        <p class="signature-text">
                            A SAUDI/SAPCO, representada pelo Operador: <strong>${dadosFicha.operador1}</strong>
                            <span class="field-label">Ponto:</span> <strong>${operadoresPontos[dadosFicha.operador1] || 'N/A'}</strong>
                        </p>
                        <p class="signature-text" style="margin-top: 2rem;">
                            Rubrica: <span class="signature-line"></span> recolheu, em <strong>${retirada.data}</strong>, às <strong>${retirada.hora}</strong>
                        </p>
                    </div>
                `;

                container.appendChild(fichaDiv);
            });
        }
    </script>
</body>
</html>
